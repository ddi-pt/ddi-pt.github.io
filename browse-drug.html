<!DOCTYPE html>
<html lang="en" class="h-100">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1, user-scalable=no">
    <title>DDIPT-Browse Drug</title>
    <link rel="icon" href="https://ddi-pt.github.io/favicon.ico">
    <link rel="stylesheet" href="https://ddi-pt.github.io/css/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="https://ddi-pt.github.io/css/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="https://ddi-pt.github.io/css/bootstrap-table/bootstrap-table.min.css">
</head>

<body class="d-flex flex-column h-100">
<header class="bg-dark">
    <div class="container border-bottom">
        <div class="row">
            <div class="p-4 col-7">
                <h1 class="text-white"><font color="#2828FF">DDI</font> Prediction Tool</h1>
                <span class="text-muted">Predict drug-drug interaction with LINCS</span>
            </div>
        </div>
    </div>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="https://ddi-pt.github.io/">&nbsp;<i class="fa fa-user-md" aria-hidden="true"></i></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarsExample07">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="https://ddi-pt.github.io/">&nbsp;&nbsp;&nbsp;Home&nbsp;&nbsp;&nbsp;</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://ddi-pt.github.io/predict">&nbsp;&nbsp;&nbsp;Predict&nbsp;&nbsp;&nbsp;</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://ddi-pt.github.io/download">&nbsp;&nbsp;&nbsp;Download&nbsp;&nbsp;&nbsp;</a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item dropdown active">
                        <a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">&nbsp;&nbsp;&nbsp;Browse&nbsp;&nbsp;&nbsp;</a>
                        <div class="dropdown-menu" aria-labelledby="dropdown07">
                            <a class="dropdown-item" href="https://ddi-pt.github.io/browse-drug">Drug</a>
                            <a class="dropdown-item" href="https://ddi-pt.github.io/browse-lincs">LINCS</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<main role="main" class="container flex-shrink-0">
    <br>
    <br>
    <div class="row">
        <div class="col-md-3">

            <div class="card">
                <div class="card-header">
                    Drug Filter
                </div>
                <div class="card-body">
                    <select id="op-d" class="custom-select">
                        <option selected="selected" value="all">All drugs</option>
                        <option value="selected">Selected drugs</option>
                    </select>

                    <div id="s-d" style="display: none;">
                        <div class="row mt-3">
                            <div class="col-8 offset-2">
                                <button type="button" class="btn btn-secondary btn-block" type="button" data-toggle="modal" data-target="#Modal-d">Add</button>
                            </div>
                            <div class="col-12">
                                <ul class="list-group mt-3" id="d-l">

                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <br>

            <div class="card">
                <div class="card-header">
                    Protein type Filter
                </div>
                <div class="card-body">
                    <select id="op-pt" class="custom-select">
                        <option selected="selected" value="all">All protein types</option>
                        <option value="selected">Selected protein types</option>
                    </select>

                    <div id="s-pt" style="display: none;">
                        <div class="row mt-3">
                            <div class="col-8 offset-2">
                                <button type="button" class="btn btn-secondary btn-block" type="button" data-toggle="modal" data-target="#Modal-pt">Add</button>
                            </div>
                            <div class="col-12">
                                <ul class="list-group mt-3" id="pt-l">

                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <br>
            <div class="card">
                <div class="card-header">
                    Protein Filter
                </div>
                <div class="card-body">
                    <select id="op-p" class="custom-select">
                        <option selected="selected" value="all">All proteins</option>
                        <option value="selected">Selected proteins</option>
                    </select>

                    <div id="s-p" style="display: none;">
                        <div class="row mt-3">
                            <div class="col-8 offset-2">
                                <button type="button" class="btn btn-secondary btn-block" type="button" data-toggle="modal" data-target="#Modal-p">Add</button>
                            </div>
                            <div class="col-12">
                                <ul class="list-group mt-3" id="p-l">

                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <br>


            <div class="card">
                <div class="card-header">
                    Action Filter
                </div>
                <div class="card-body">
                    <select id="op-a" class="custom-select">
                        <option selected="selected" value="all">All actions</option>
                        <option value="selected">Selected actions</option>
                    </select>

                    <div id="s-a" style="display: none;">
                        <div class="row mt-3">
                            <div class="col-8 offset-2">
                                <button type="button" class="btn btn-secondary btn-block" type="button" data-toggle="modal" data-target="#Modal-a">Add</button>
                            </div>
                            <div class="col-12">
                                <ul class="list-group mt-3" id="a-l">

                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <br>
            <br>
        </div>

        <div class="col-md-9">

            <div class="card">
                <div class="card-body">
                    <div id="exportToolbar">
                        <select id="sel_exportoption" class="custom-select">
                            <option selected="selected" value="selected">Export selected data</option>
                            <option value="basic">Export data in this page</option>
                            <option value="all">Export all data</option>
                        </select>
                    </div>
                    <div class="table-responsive">
                        <table id="table-drug"></table>
                    </div>
                    <br>
                </div>
            </div>

        </div>
    </div>
    <br>
    <br>

    <div class="modal fade" id="Modal-d" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel">Selelct a drug</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="toolbar-d">
                        <button id="re-bt-d" class="btn btn-secondary">Reset</button>
                    </div>
                    <div class="table-responsive">
                        <table id="table-d"></table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal" id="ok-d">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="Modal-pt" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel">Selelct a protein type</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="toolbar-pt">
                        <button id="re-bt-pt" class="btn btn-secondary">Reset</button>
                    </div>
                    <div class="table-responsive">
                        <table id="table-pt"></table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal" id="ok-pt">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="Modal-p" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel">Selelct a protein</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="toolbar-p">
                        <button id="re-bt-p" class="btn btn-secondary">Reset</button>
                    </div>
                    <div class="table-responsive">
                        <table id="table-p"></table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal" id="ok-p">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="Modal-a" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel">Selelct an action</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="toolbar-a">
                        <button id="re-bt-a" class="btn btn-secondary">Reset</button>
                    </div>
                    <div class="table-responsive">
                        <table id="table-a"></table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal" id="ok-a">OK</button>
                </div>
            </div>
        </div>
    </div>

</main>

<footer class="footer mt-auto py-2 bg-dark">
    <div class="container">
        <h4 class="text-white float-left m-1"><font color="#2828FF">DDI</font>PT</h4>
        <div class="float-right">
            <small class="d-block text-muted mt-2">&copy; 2020&nbsp;&nbsp;&nbsp;<i class="fa fa-bug" aria-hidden="true"></i>&nbsp;Version 1.1</small>
        </div>
    </div>
</footer>

<script src="https://ddi-pt.github.io/js/jquery/jquery.min.js"></script>
<script src="https://ddi-pt.github.io/js/popper/popper.min.js"></script>
<script src="https://ddi-pt.github.io/js/bootstrap/bootstrap.min.js"></script>
<script src="https://ddi-pt.github.io/js/bootstrap-table/bootstrap-table.min.js"></script>
<script src="https://ddi-pt.github.io/js/tableExport/tableExport.min.js"></script>
<script src="https://ddi-pt.github.io/js/bootstrap-table/extensions/export/bootstrap-table-export.min.js"></script>

<script>
    $('#table-drug').bootstrapTable({
        url: 'https://pharmpkdb.com:14488/model/browse_drug',
        contentType: 'application/x-www-form-urlencoded',
        clickToSelect: true,
        maintainMetaData: true,
        toolbar: '#exportToolbar',
        clickToSelect: true,
        showExport: true,
        exportDataType: 'selected',
        cache: true,
        striped: true,
        pagination: true,
        pageList: [10, 20, 50, 100],
        sidePagination: 'client',
        columns: [
            {
                field: 'state',
                checkbox: true,
                align: 'center',
            }, {
                field: 'drug_id',
                title: 'Drug Id',
                sortable:true,
            }, {
                field: 'drug_name',
                title: 'Drug Name',
                sortable:true,
            },{
                field: 'protein_id',
                title: 'Protein Id',
                sortable:true,
            }, {
                field: 'protein_type',
                title: 'Protein Type',
                sortable:true,
            }, {
                field: 'protein_name',
                title: 'Protein Name',
                sortable:true,
            }, {
                field: 'action',
                title: 'Action',
                sortable:true,
            }
        ]
    });
    $("#sel_exportoption").change(function () {
        $('#table-drug').bootstrapTable('refreshOptions', {
            exportDataType: $(this).val()
        });
    });
    $("#op-d").change(function () {
        if ($(this).val() == 'selected') {
            $("#s-d").show();
        } else if ($(this).val() == 'all'){
            $("#s-d").hide();
            $("#d-l").empty();
            sel_d = [];
            filter_refresh();
        };
    });

    function delRow_d(obj) {
        rd = $(obj).parent()[0].innerText;
        rd = rd.slice(0,rd.length-2);
        sel_d.forEach(function(item, index, arr) {
            if(item === rd) {
                arr.splice(index, 1);
            }
        });
        filter_refresh();
        $(obj).parent().remove();
    };

    $('#table-d').bootstrapTable({
        url: 'https://pharmpkdb.com:14488/model/browse_drug_d',
        contentType: 'application/x-www-form-urlencoded',
        toolbar: '#toolbar-d',
        toolbarAlign: 'right',
        clickToSelect: true,
        singleSelect: true,
        search: true,
        showSearchButton: true,
        searchAlign: 'left',
        maintainMetaData: true,
        cache: true,
        striped: true,
        pagination: true,
        pageList: [5, 10, 20],
        sidePagination: 'client',
        columns: [
            {
                field: 'state',
                checkbox: true,
                align: 'center',
            }, {
                field: 'drug_id',
                title: 'Drug Id',
                sortable:true,
            }, {
                field: 'name',
                title: 'Name',
                sortable:true,
            },{
                field: 'type',
                title: 'Type',
                sortable:true,
            }, {
                field: 'cas_number',
                title: 'Cas Number',
                sortable:true,
            }
        ]
    });

    $(function(){
        $("#re-bt-d").click(function(){
            $("#table-d").bootstrapTable('resetSearch');
        });
    });

    var d_name;
    $(function(){
        $('#table-d').on('check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table',
            function (e, rowsAfter, rowsBefore) {
                var rows = rowsAfter;

                if (e.type === 'uncheck-all') {
                    rows = rowsBefore;
                };

                d_name = $.map(!$.isArray(rows) ? [rows] : rows, function (row) {
                    return row.name;
                });
            });
    });

    var sel_d = [];

    $(function(){
        $("#ok-d").click(function(){
            if ($.inArray(d_name[0], sel_d) == -1) {
                sel_d.push(d_name[0]);
                $("#d-l").append("<li class='list-group-item'>" + d_name[0] + "<button type='button' class='close' onclick='delRow_d(this)'><span aria-hidden='true'>&times;</span></button></li>");
                filter_refresh();
            } else {

            };
        });
    });

    $('#table-pt').bootstrapTable({
        url: 'https://pharmpkdb.com:14488/model/browse_drug_pt',
        contentType: 'application/x-www-form-urlencoded',
        toolbar: '#toolbar-pt',
        toolbarAlign: 'right',
        clickToSelect: true,
        singleSelect: true,
        search: true,
        showSearchButton: true,
        searchAlign: 'left',
        maintainMetaData: true,
        cache: true,
        striped: true,
        pagination: true,
        pageList: [5, 10, 20],
        sidePagination: 'client',
        columns: [
            {
                field: 'state',
                checkbox: true,
                align: 'center',
            }, {
                field: 'protein_type',
                title: 'Protein Type',
                sortable:true,
                align: 'center',
            }
        ]
    });

    $(function(){
        $("#re-bt-pt").click(function(){
            $("#table-pt").bootstrapTable('resetSearch');
        });
    });

    var pt_name;
    $(function(){
        $('#table-pt').on('check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table',
            function (e, rowsAfter, rowsBefore) {
                var rows = rowsAfter;

                if (e.type === 'uncheck-all') {
                    rows = rowsBefore;
                };

                pt_name = $.map(!$.isArray(rows) ? [rows] : rows, function (row) {
                    return row.protein_type;
                });
            });
    });

    var sel_pt = [];

    $(function(){
        $("#ok-pt").click(function(){
            if ($.inArray(pt_name[0], sel_pt) == -1) {
                sel_pt.push(pt_name[0]);
                $("#pt-l").append("<li class='list-group-item'>" + pt_name[0] + "<button type='button' class='close' onclick='delRow_pt(this)'><span aria-hidden='true'>&times;</span></button></li>");
                filter_refresh();
            } else {

            };
        });
    });

    $("#op-pt").change(function () {
        if ($(this).val() == 'selected') {
            $("#s-pt").show();
        } else if ($(this).val() == 'all'){
            $("#s-pt").hide();
            $("#pt-l").empty();
            sel_pt = [];
            filter_refresh();
        };
    });

    function delRow_pt(obj) {
        rd = $(obj).parent()[0].innerText;
        rd = rd.slice(0,rd.length-2);
        sel_pt.forEach(function(item, index, arr) {
            if(item === rd) {
                arr.splice(index, 1);
            }
        });
        filter_refresh();
        $(obj).parent().remove();
    };

    $('#table-p').bootstrapTable({
        url: 'https://pharmpkdb.com:14488/model/browse_drug_p',
        contentType: 'application/x-www-form-urlencoded',
        toolbar: '#toolbar-p',
        toolbarAlign: 'right',
        clickToSelect: true,
        singleSelect: true,
        search: true,
        showSearchButton: true,
        searchAlign: 'left',
        maintainMetaData: true,
        cache: true,
        striped: true,
        pagination: true,
        pageList: [5, 10, 20],
        sidePagination: 'client',
        columns: [
            {
                field: 'state',
                checkbox: true,
                align: 'center',
            }, {
                field: 'protein_id',
                title: 'Protein Id',
                sortable:true,
            }, {
                field: 'protein_type',
                title: 'Protein Type',
                sortable:true,
            },{
                field: 'protein_name',
                title: 'Protein Name',
                sortable:true,
            }, {
                field: 'organism',
                title: 'Organism',
                sortable:true,
            },{
                field: 'gene_symbol',
                title: 'Gene Symbol',
                sortable:true,
            }, {
                field: 'uniprot_id',
                title: 'Uniprot Id',
                sortable:true,
            }
        ]
    });

    $(function(){
        $("#re-bt-p").click(function(){
            $("#table-p").bootstrapTable('resetSearch');
        });
    });

    var p_name;
    $(function(){
        $('#table-p').on('check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table',
            function (e, rowsAfter, rowsBefore) {
                var rows = rowsAfter;

                if (e.type === 'uncheck-all') {
                    rows = rowsBefore;
                };

                p_name = $.map(!$.isArray(rows) ? [rows] : rows, function (row) {
                    return row.protein_name;
                });
            });
    });

    var sel_p = [];

    $(function(){
        $("#ok-p").click(function(){
            if ($.inArray(p_name[0], sel_p) == -1) {
                sel_p.push(p_name[0]);
                $("#p-l").append("<li class='list-group-item'>" + p_name[0] + "<button type='button' class='close' onclick='delRow_p(this)'><span aria-hidden='true'>&times;</span></button></li>");
                filter_refresh();
            } else {

            };
        });
    });

    $("#op-p").change(function () {
        if ($(this).val() == 'selected') {
            $("#s-p").show();
        } else if ($(this).val() == 'all'){
            $("#s-p").hide();
            $("#p-l").empty();
            sel_p = [];
            filter_refresh();
        };
    });

    function delRow_p(obj) {
        rd = $(obj).parent()[0].innerText;
        rd = rd.slice(0,rd.length-2);
        sel_p.forEach(function(item, index, arr) {
            if(item === rd) {
                arr.splice(index, 1);
            }
        });
        filter_refresh();
        $(obj).parent().remove();
    };

    $('#table-a').bootstrapTable({
        url: 'https://pharmpkdb.com:14488/model/browse_drug_a',
        contentType: 'application/x-www-form-urlencoded',
        toolbar: '#toolbar-a',
        toolbarAlign: 'right',
        clickToSelect: true,
        singleSelect: true,
        search: true,
        showSearchButton: true,
        searchAlign: 'left',
        maintainMetaData: true,
        cache: true,
        striped: true,
        pagination: true,
        pageList: [5, 10, 20],
        uniqueId: 'DrugBank-Id',
        sidePagination: 'client',
        columns: [
            {
                field: 'state',
                checkbox: true,
                align: 'center',
            }, {
                field: 'action',
                title: 'Action',
                sortable:true,
                align: 'center',
            }
        ]
    });

    $(function(){
        $("#re-bt-a").click(function(){
            $("#table-a").bootstrapTable('resetSearch');
        });
    });

    var a_name;
    $(function(){
        $('#table-a').on('check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table',
            function (e, rowsAfter, rowsBefore) {
                var rows = rowsAfter;

                if (e.type === 'uncheck-all') {
                    rows = rowsBefore;
                };

                a_name = $.map(!$.isArray(rows) ? [rows] : rows, function (row) {
                    return row.action;
                });
            });
    });

    var sel_a = [];

    $(function(){
        $("#ok-a").click(function(){
            if ($.inArray(a_name[0], sel_a) == -1) {
                sel_a.push(a_name[0]);
                $("#a-l").append("<li class='list-group-item'>" + a_name[0] + "<button type='button' class='close' onclick='delRow_a(this)'><span aria-hidden='true'>&times;</span></button></li>");
                filter_refresh();
            } else {

            };
        });
    });

    $("#op-a").change(function () {
        if ($(this).val() == 'selected') {
            $("#s-a").show();
        } else if ($(this).val() == 'all'){
            $("#s-a").hide();
            $("#a-l").empty();
            sel_a = [];
            filter_refresh();
        };
    });

    function delRow_a(obj) {
        rd = $(obj).parent()[0].innerText;
        rd = rd.slice(0,rd.length-2);
        sel_a.forEach(function(item, index, arr) {
            if(item === rd) {
                arr.splice(index, 1);
            }
        });
        filter_refresh();
        $(obj).parent().remove();
    };

    function filter_refresh() {
        var f_l = {};
        if (sel_d.length != 0) {
            f_l.drug_name = sel_d;
        };
        if (sel_pt.length != 0) {
            f_l.protein_type = sel_pt;
        };
        if (sel_p.length != 0) {
            f_l.protein_name = sel_p;
        };
        if (sel_a.length != 0) {
            f_l.action = sel_a;
        };
        $('#table-drug').bootstrapTable('filterBy', f_l, { 'filterAlgorithm': 'and'});
    };

</script>
</body>
</html>
